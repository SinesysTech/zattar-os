# Event Types

<cite>
**Referenced Files in This Document**   
- [common.ts](file://types/domain/common.ts)
- [audiencias.ts](file://types/domain/audiencias.ts)
- [acervo.ts](file://types/domain/acervo.ts)
- [README.md](file://README.md)
- [page.tsx](file://app/ajuda/desenvolvimento/arquitetura/page.tsx)
- [sincronizar-timeline-cpf.service.ts](file://backend/acervo/services/sincronizar-timeline-cpf.service.ts)
- [use-processo-timeline.ts](file://app/_lib/hooks/use-processo-timeline.ts)
- [processo-visualizacao.tsx](file://app/(dashboard)/processos/[id]/processo-visualizacao.tsx)
</cite>

## Table of Contents
1. [Introduction](#introduction)
2. [Event Structure and Properties](#event-structure-and-properties)
3. [Event Naming Conventions and Categorization](#event-naming-conventions-and-categorization)
4. [Relationship Between Events and Aggregates](#relationship-between-events-and-aggregates)
5. [Versioning and Backward Compatibility](#versioning-and-backward-compatibility)

## Introduction
This document provides a comprehensive overview of the event types used in the Sinesys system. Events in Sinesys are designed as immutable data structures that capture significant business occurrences within the legal domain. These events serve as a critical mechanism for maintaining system state, enabling audit trails, and facilitating communication between different parts of the application. The event system is deeply integrated with the domain-driven design (DDD) principles that underpin the architecture of Sinesys, ensuring that business logic and state changes are properly encapsulated and traceable.

**Section sources**
- [README.md](file://README.md#L265-L283)
- [page.tsx](file://app/ajuda/desenvolvimento/arquitetura/page.tsx#L67-L97)

## Event Structure and Properties
Events in Sinesys are structured as immutable data objects that contain essential information about business occurrences. Each event typically includes a timestamp, event type identifier, and payload data relevant to the specific business action. The system follows a consistent pattern for event definition, with events being represented as TypeScript interfaces in the domain types directory.

The core properties of events in Sinesys include:
- **Timestamp**: All events capture when they occurred, typically using ISO timestamp format
- **Event Type**: A string identifier that categorizes the nature of the event
- **Payload Data**: Domain-specific information relevant to the event
- **Aggregate Reference**: A reference to the aggregate root that generated the event

For example, the system defines events like `ProcessTimelineSynchronized`, which would capture the synchronization of a process timeline, and `HearingCreated`, which represents the creation of a new hearing in the system. These events are defined in the domain type files such as `audiencias.ts` and `acervo.ts`, where they are structured as interfaces with specific properties relevant to their domain context.

**Section sources**
- [audiencias.ts](file://types/domain/audiencias.ts#L1-L77)
- [acervo.ts](file://types/domain/acervo.ts#L1-L81)
- [common.ts](file://types/domain/common.ts#L1-L49)

## Event Naming Conventions and Categorization
Sinesys follows a consistent naming convention for events across its bounded contexts. Events are named using PascalCase and follow the pattern of [Aggregate][Action], where the aggregate name comes first followed by the action that occurred. This convention makes it easy to understand both the context and nature of the event from its name alone.

The system categorizes events by their bounded context, with separate event types defined for different domains such as acervo (case management), audiencias (hearings), and contratos (contracts). This categorization is reflected in the file structure, with event definitions organized in the `types/domain/` directory according to their respective domains.

Examples of event naming patterns in Sinesys include:
- `ProcessTimelineSynchronized`: Indicates synchronization of a process timeline
- `HearingCreated`: Represents the creation of a new hearing
- `ContractGenerated`: Signifies the generation of a contract document

This consistent naming and categorization strategy enables developers to quickly understand the purpose and context of any event in the system, while also making it easier to search for and locate specific event types.

**Section sources**
- [audiencias.ts](file://types/domain/audiencias.ts#L1-L77)
- [acervo.ts](file://types/domain/acervo.ts#L1-L81)
- [README.md](file://README.md#L265-L283)

## Relationship Between Events and Aggregates
In Sinesys, events are closely tied to aggregates, which are clusters of domain objects treated as a single unit for data changes. Each event is typically generated by an aggregate root in response to a business action, creating a clear audit trail of state changes within the system.

The relationship between events and aggregates follows the domain-driven design pattern where aggregates are responsible for maintaining consistency within their boundaries. When a business action modifies an aggregate, the aggregate emits one or more events to communicate the change to the rest of the system. For example, when a process timeline is synchronized, the Acervo aggregate emits a `ProcessTimelineSynchronized` event.

This pattern ensures that all state changes are properly recorded and can be replayed if necessary, supporting features like event sourcing and temporal queries. The aggregate-event relationship also enables loose coupling between system components, as other parts of the system can react to events without having direct dependencies on the aggregates that generated them.

**Section sources**
- [sincronizar-timeline-cpf.service.ts](file://backend/acervo/services/sincronizar-timeline-cpf.service.ts#L79-L95)
- [use-processo-timeline.ts](file://app/_lib/hooks/use-processo-timeline.ts#L1-L189)
- [processo-visualizacao.tsx](file://app/(dashboard)/processos/[id]/processo-visualizacao.tsx#L50-L76)

## Versioning and Backward Compatibility
Sinesys employs a careful approach to event schema versioning and backward compatibility. Since events represent historical facts, their schemas must be maintained in a way that preserves the ability to interpret past events while allowing for system evolution.

The system follows a pattern of additive changes to event schemas, where new fields can be added but existing fields should not be modified or removed. When significant changes are required, the system may introduce new event types rather than modifying existing ones, preserving the integrity of the event history.

Backward compatibility is maintained through careful type design in TypeScript, with optional fields and union types used to accommodate variations in event payloads. The system also leverages the domain type definitions in the `types/domain/` directory as a single source of truth for event structures, ensuring consistency across the codebase.

This approach allows Sinesys to evolve its event model over time while maintaining the ability to process historical events and ensuring that different components of the system can interoperate reliably.

**Section sources**
- [common.ts](file://types/domain/common.ts#L1-L49)
- [audiencias.ts](file://types/domain/audiencias.ts#L1-L77)
- [acervo.ts](file://types/domain/acervo.ts#L1-L81)